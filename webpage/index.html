<!DOCTYPE html>
<html>
<head>
    <title>Inverted Index Search</title>
    <script></script>
</head>

<body>
    <div align="center">
        <h1>Search for Word</h1>
        <form id="searchForm">
            <input type="text" name="Term" id="Term"/>
            <button type="submit">Search</button>
        </form>
        <div id='resultsdiv'>
        </div>
        <table id="resultstable">
        </table>
        
        
    </div>

    <script>
        const searchForm = document.getElementById("searchForm")

        searchForm.addEventListener('submit', function (e){
            e.preventDefault();

            const formData = new FormData(this);
            var object = {};
            formData.forEach(function(v, k){
                object[k] = v;
            });
            var json = JSON.stringify(object)
            fetch('https://us-central1-cloud-computing-327315.cloudfunctions.net/RyoostSearchHttp', {
                method: 'post',
                body: json
            }).then(function (response) {
                console.log(response);
                return response.json()
            }).then(function (data) {
                console.log(data)
                var table = document.getElementById('resultstable');
                var div = document.getElementById('resultsdiv')
                while (div.firstChild) {
                    div.removeChild(div.firstChild);
                }
                while (table.firstChild) {
                    table.removeChild(table.firstChild);
                }
                if (data.results == null) {
                    div.innerHTML = '<p>No results found</p>'
                }
                else {
                    data.results.forEach(function (obj) {
                    var r = table.insertRow(-1);
                    var t = r.insertCell(0);
                    var c = r.insertCell(1);

                    t.innerHTML = obj.title;
                    c.innerHTML = obj.count;
                    });
                }
            }).catch(function (error) {
                console.log(error)
            });
        });

    </script>
</body>
</html>